### **1. 连接建立阶段（三次握手）**

- **LISTEN**
  服务端调用 `listen()` 后进入监听状态，等待客户端的 `SYN` 请求。此时 Socket 准备好接受新连接。
- **SYN_SENT** (客户端)
  客户端发送 `SYN` 包（第一次握手）后进入此状态，等待服务端的 `SYN-ACK` 响应。
- **SYN_RECEIVED** (服务端)
  服务端收到客户端的 `SYN` 后，回复 `SYN-ACK`（第二次握手），并等待客户端的最终 `ACK`。
- **ESTABLISHED**
  客户端收到 `SYN-ACK` 后发送 `ACK`（第三次握手），双方连接建立成功，进入数据传输阶段。

------

### **2. 数据传输阶段**

- **ESTABLISHED**
  连接已建立，双方可通过 `send()` 和 `recv()` 进行双向数据传输。

------

### **3. 连接终止阶段（四次挥手）**

- **FIN_WAIT_1** (主动关闭方)
  主动关闭方（如客户端）调用 `close()` 发送 `FIN` 包（第一次挥手），等待对方的 `ACK`。
- **FIN_WAIT_2** (主动关闭方)
  收到对方对 `FIN` 的 `ACK`（第二次挥手）后进入此状态，等待对方发送 `FIN` 包。
- **CLOSE_WAIT** (被动关闭方)
  被动关闭方收到 `FIN` 后进入此状态，需调用 `close()` 发送自己的 `FIN` 包（延迟关闭可能导致此状态堆积）。
- **LAST_ACK** (被动关闭方)
  被动关闭方发送 `FIN` 包（第三次挥手）后等待最后的 `ACK`。
- **TIME_WAIT** (主动关闭方)
  主动关闭方收到对方的 `FIN` 后发送 `ACK`（第四次挥手），并等待 **2MSL**（最长报文段寿命）时间，确保对方收到 `ACK`，防止旧连接数据干扰新连接。
- **CLOSED**
  连接完全关闭，释放资源。
------
### **4. 异常状态**

- **CLOSING**
  双方同时尝试关闭连接时出现，等待对方确认。
- **RESET (RST)**
  连接被强制终止（如端口未监听、超时、异常数据），发送 `RST` 包立即中断连接。

------